# Fintech Gateway

## 프로젝트 개요

핀테크 도메인 API Gateway 서비스.
JWT 인증, 라우팅, Rate Limiting, 보안 기능을 담당합니다.

### 기술 스택
- **JDK**: 21 LTS
- **Kotlin**: 2.0.x
- **Spring Boot**: 3.3.x
- **Spring Cloud Gateway**: 4.1.x
- **Database**: MySQL 8.0
- **Cache**: Redis

### 도메인
- **분류**: fintech (핀테크/금융)
- **컴플라이언스**: PCI-DSS, 전자금융감독규정, 개인정보보호법

---

## 세션 시작 시 필수

```bash
# 1. 최신 상태 동기화
git checkout develop
git pull origin develop

# 2. 상태 요약 보기
/skill-status

# 3. 다음 작업 가져오기
/skill-plan
```

---

## 에이전트

### 활성화된 에이전트

| 에이전트 | 역할 | 트리거 |
|---------|------|--------|
| `@agent-pm` | 워크플로우 오케스트레이션 | 자연어 요청 자동 분석 |
| `@agent-backend` | 백엔드 개발 | "구현", "코드 작성" |
| `@agent-code-reviewer` | 5관점 코드 리뷰 | "리뷰해줘" |
| `@agent-qa` | 테스트 설계 및 검증 | "테스트", "검증" |

### 비활성화된 에이전트

- `agent-planner` (기획)
- `agent-frontend` (프론트엔드)
- `agent-docs` (문서화)
- `agent-db-designer` (DB 설계)
- `agent-devops` (인프라)

필요 시 `project.json`의 `agents.enabled`에 추가하여 활성화할 수 있습니다.

---

## 스킬

| 스킬 | 설명 | 자연어 |
|------|------|--------|
| `/skill-status` | 상태 확인 | "상태 확인해줘" |
| `/skill-backlog` | 백로그 조회 | "백로그 보여줘" |
| `/skill-feature` | 새 기능 기획 | "새 기능 기획해줘" |
| `/skill-plan` | 설계 + 스텝 계획 | "다음 작업 가져와줘" |
| `/skill-impl` | 구현 + PR 생성 | "개발 진행해줘" |
| `/skill-review-pr` | PR 리뷰 | "PR 리뷰해줘" |
| `/skill-merge-pr` | PR 머지 | "PR 머지해줘" |
| `/skill-docs` | 참고자료 | "결제 플로우 참고자료" |

---

## 개발 시 자동 참조 규칙

### 키워드 → 참고자료 매핑

| 키워드 | 참조 문서 |
|--------|----------|
| 결제, 승인, 인증 | `payment-flow.md` |
| 정산, 수수료 | `settlement.md` |
| 취소, 환불 | `refund-cancel.md` |
| PCI-DSS, 암호화 | `security-compliance.md` |
| 토큰, JWT | `token-auth.md` |
| 에러코드 | `error-handling.md` |

---

## 코드 리뷰 체크리스트

### 1. 컴플라이언스 (fintech 특화)
- [ ] PCI-DSS 준수
- [ ] 전자금융감독규정 준수
- [ ] 감사 로그 기록
- [ ] 개인정보 마스킹

### 2. 도메인 로직
- [ ] 상태머신 정합성
- [ ] BigDecimal 사용 (금액)
- [ ] 멱등성 보장
- [ ] 동시성 처리

### 3. 아키텍처
- [ ] Circuit Breaker 패턴
- [ ] Saga 패턴 (분산 트랜잭션)
- [ ] 장애 격리

### 4. 보안
- [ ] JWT 로깅 금지
- [ ] SQL Injection 방지
- [ ] Rate Limiting

### 5. 테스트
- [ ] 커버리지 80% 이상
- [ ] 실패 케이스 테스트
- [ ] 동시성 테스트

---

## Git 브랜치 전략

```
main (운영)
  └── develop (개발 통합)
        └── feature/TASK-XXX-stepN (스텝별 개발)
```

### 커밋 메시지 규칙
```
<type>: <description>

Types: feat, fix, refactor, docs, test, chore
예: feat: TASK-001 Step 1 - JWT 서비스 인터페이스
```

---

## 에러 코드 체계

| 코드 | HTTP | 설명 |
|------|------|------|
| PG-GW-001 | 401 | TOKEN_MISSING |
| PG-GW-002 | 401 | TOKEN_INVALID_FORMAT |
| PG-GW-003 | 401 | TOKEN_EXPIRED |
| PG-GW-004 | 401 | TOKEN_INVALID_SIGNATURE |
| PG-GW-005 | 403 | ACCESS_DENIED |
| PG-GW-006 | 429 | RATE_LIMIT_EXCEEDED |
| PG-GW-012 | 401 | INVALID_CREDENTIALS |

---

## 보안 규칙

### JWT 보안
- 알고리즘: HMAC-SHA256 (HS256)
- 비밀키: 256bit 이상
- Access Token: 1시간 만료
- Refresh Token: 7일 만료

### 로깅 보안
- 토큰 평문 로깅 **절대 금지**
- 비밀번호 로깅 **절대 금지**
- 민감정보 마스킹 필수

---

## 테스트 규칙

### 커버리지 목표
- 단위 테스트: 80%+
- 통합 테스트: 주요 플로우 100%

### 필수 테스트 항목
- JWT 토큰 발급/검증
- Token Rotation
- Token Reuse Detection


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>